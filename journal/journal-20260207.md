# Journal â€” 2026-02-07

## Summary

Set up fresh Python venv, ran all tests, and made several improvements to the edgar-db project.

## Changes

### 1. README overhaul
- Updated root `README.md` to document all three packages (`edgar_db`, `yfinance_db`, `edgar_ui`)
- Added Yahoo Finance as a data source
- Added yfinance-db CLI examples
- Added test summary table
- Added Configuration section with all environment variables (`EDGAR_USER_AGENT`, `EDGAR_DB_PATH`, `YFINANCE_DB_PATH`)

### 2. Fixed CLI multi-ticker syntax in READMEs
- `--ticker` with `multiple=True` requires repeating the flag per ticker
- Fixed `README.md`, `db/README.md`: `--ticker AAPL MSFT GOOGL` changed to `-t AAPL -t MSFT -t GOOGL`

### 3. Added `--sp500` flag to `yfinance-db download`
- Reuses `edgar_db.sp500.get_sp500_tickers()` to fetch S&P 500 component list from Wikipedia
- Added test `test_download_sp500` in `db/tests/test_yfinance/test_cli.py`
- Total tests: 126 (41 edgar_db + 47 yfinance_db + 38 UI)

### 4. Fixed `sp500.py` issues
- **Missing `lxml`**: Added `lxml>=5.0` to `pyproject.toml` dependencies (required by `pd.read_html()`)
- **SSL cert error on macOS**: Changed from `pd.read_html(url)` to fetching HTML via `httpx` first, then passing the string to `pd.read_html(StringIO(html))`
- **Wikipedia 403 Forbidden**: Added proper `User-Agent` header to httpx request

### 5. Project-local SQLite database paths
- Created `.env` file with `EDGAR_DB_PATH=./data/edgar.db` and `YFINANCE_DB_PATH=./data/yfinance.db`
- Modified `.venv/bin/activate` to auto-source `.env` on activation
- Added `.env` and `data/` to `.gitignore`
- Databases now default to `./data/` under the project root instead of `~/`

### 6. Downloaded data
- Downloaded AAPL, MSFT, GOOGL via `edgar-db download`
- Started full S&P 500 download via `yfinance-db download --sp500` (503 tickers)

## Files Modified
- `README.md`
- `db/README.md`
- `db/src/edgar_db/sp500.py`
- `db/src/yfinance_db/cli.py`
- `db/tests/test_yfinance/test_cli.py`
- `pyproject.toml`
- `.gitignore`
- `.env` (new)
- `.venv/bin/activate`
